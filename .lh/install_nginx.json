{
    "sourceFile": "install_nginx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 1,
            "patches": [
                {
                    "date": 1660106941700,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1660107142017,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -33,11 +33,13 @@\n \r\n #nginx\r\n \r\n useradd nginx -s /sbin/nologin -M\r\n+systemctl stop apache2.service\r\n+rm /etc/systemd/system/multi-user.target.wants/apache2.service\r\n \r\n-cat > /etc/systemd/system/nginx.service <<EOF\r\n \r\n+cat >/etc/systemd/system/nginx.service <<EOF\r\n [Unit]\r\n Description=The NGINX HTTP and reverse proxy server\r\n After=syslog.target network-online.target remote-fs.target nss-lookup.target\r\n Wants=network-online.target\r\n@@ -52,9 +54,8 @@\n PrivateTmp=true\r\n \r\n [Install]\r\n WantedBy=multi-user.target\r\n-\r\n EOF\r\n \r\n systemctl daemon-reload\r\n systemctl enable nginx.service\r\n"
                }
            ],
            "date": 1660106941700,
            "name": "Commit-0",
            "content": "apt-get update\r\napt-get install build-essential libssl-dev -y\r\nrm -rf ./pcre*\r\nwget  https://raw.githubusercontent.com/SpiritedAwayLab/installnginx/master/pcre-8.42.tar.gz  \r\ntar -zxf pcre-8.42.tar.gz\r\ncd pcre-8.42\r\n./configure\r\nmake\r\nmake install\r\n\r\ncd\r\nrm -rf ./zlib*\r\nwget https://raw.githubusercontent.com/SpiritedAwayLab/installnginx/master/zlib-1.2.11.tar.gz\r\ntar -zxf zlib-1.2.11.tar.gz\r\ncd zlib-1.2.11\r\n./configure\r\nmake\r\nmake install\r\n\r\ncd\r\nrm -rf nginx*\r\nwget https://raw.githubusercontent.com/SpiritedAwayLab/installnginx/master/nginx-1.21.4.tar.gz\r\ntar zxf nginx-1.21.4.tar.gz\r\ncd nginx-1.21.4\r\n./configure --sbin-path=/usr/local/nginx/nginx --conf-path=/usr/local/nginx/nginx.conf --pid-path=/usr/local/nginx/nginx.pid --with-pcre=../pcre-8.42 --with-zlib=../zlib-1.2.11 --with-stream --with-stream_ssl_module --with-stream_ssl_preread_module --with-http_ssl_module\r\n\r\nmake\r\nmake install\r\ncp /usr/local/nginx/nginx /usr/bin\r\n\r\n#openssl ecparam -out /etc/ssl/private/ssl-nginx.key -name prime256v1 -genkey\r\n#openssl req -new -days 3650 -nodes -x509 -subj \"/C=US/ST=Denial/L=Springfield/O=Dis/CN=www.example.com\" -key /etc/ssl/private/ssl-nginx.key -out /etc/ssl/certs/ssl-nginx.cert\r\n\r\n#nginx\r\n\r\nuseradd nginx -s /sbin/nologin -M\r\n\r\ncat > /etc/systemd/system/nginx.service <<EOF\r\n\r\n[Unit]\r\nDescription=The NGINX HTTP and reverse proxy server\r\nAfter=syslog.target network-online.target remote-fs.target nss-lookup.target\r\nWants=network-online.target\r\n\r\n[Service]\r\nType=forking\r\nPIDFile=/usr/local/nginx/nginx.pid\r\nExecStartPre=/usr/local/nginx/nginx -t\r\nExecStart=/usr/local/nginx/nginx\r\nExecReload=/usr/local/nginx/nginx -s reload\r\nExecStop=/bin/kill -s QUIT $MAINPID\r\nPrivateTmp=true\r\n\r\n[Install]\r\nWantedBy=multi-user.target\r\n\r\nEOF\r\n\r\nsystemctl daemon-reload\r\nsystemctl enable nginx.service\r\nsystemctl start nginx.service\r\n\r\n\r\n"
        }
    ]
}